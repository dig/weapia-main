/*
 * This file was generated by the Gradle 'init' task.
 */

//--- Configuration for all projects including sub projects
allprojects {
    group = 'com.weapia'
    version = '1.0-SNAPSHOT'
}

//--- Configuration for sub projects
subprojects {
    apply plugin: 'java'
    apply plugin: 'maven-publish'

    repositories {
        mavenLocal()
        mavenCentral()
        maven { url 'https://repo.maven.apache.org/maven2' }
        maven { url 'https://oss.sonatype.org/content/repositories/snapshots' }
        maven { url 'http://repo.dmulloy2.net/nexus/repository/public/' }
        maven { url 'https://repo.spongepowered.org/maven' }
        maven { url 'https://repo.ashcon.app/nexus/content/repositories/snapshots/' }
        maven { url 'https://repo.codemc.org/repository/maven-public/' }
        maven {
            url = 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/'

            content {
                includeGroup 'org.bukkit'
                includeGroup 'org.spigotmc'
            }
        }
    }

    sourceCompatibility = '1.8'

    publishing {
        publications {
            maven(MavenPublication) {
                from(components.java)
            }
        }
    }

    configurations {
        included
    }

    jar {
        from {
            configurations.included.collect { it.isDirectory() ? it : zipTree(it) }
        }
    }

    task copyToBuildsDir(type: Copy) {
        from 'build/libs'
        into '../bin'
    }

    copyToBuildsDir.dependsOn(jar)
    build.finalizedBy(copyToBuildsDir)

    dependencies {
        //--- Lombok
        annotationProcessor 'org.projectlombok:lombok:1.18.8'
        compileOnly 'org.projectlombok:lombok:1.18.8'

        //--- Guava
        included group: 'com.google.guava', name: 'guava', version: '11.0.2'

        //--- GSON
        included group: 'com.google.code.gson', name: 'gson', version: '2.8.5'

        //--- Guice
        included group: 'com.google.inject', name: 'guice', version: '4.2.2'
        included group: 'com.google.inject.extensions', name: 'guice-multibindings', version: '4.2.2'

        //--- Database
        included group: 'redis.clients', name: 'jedis', version: '3.1.0'
        included group: 'org.mongodb', name: 'mongodb-driver', version: '3.6.3'

        //--- Configurate
        included 'org.spongepowered:configurate-hocon:3.6'

        //--- Zip Utils
        included 'org.zeroturnaround:zt-zip:1.14'

        configurations.compile.extendsFrom(configurations.included)
    }

    compileJava.options.encoding = 'UTF-8'
    tasks.withType(JavaCompile) {
        options.encoding = 'UTF-8'
    }
}
